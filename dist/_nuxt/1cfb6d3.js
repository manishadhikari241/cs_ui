(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{462:function(t,e,o){var content=o(470);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(30).default)("92bb1f1c",content,!0,{sourceMap:!1})},463:function(t,e,o){t.exports=o.p+"img/placeholder.63ab416.jpg"},466:function(t,e,o){"use strict";o(173);var r={props:["id","baseURL","url","folder","action"],components:{BIconUpload:o(0).zv},data:function(){return{imgBaseURL:"https://newapi.collectionstock.com/storage",submitting:!1,request:{image:null}}},methods:{revokeFileUploader:function(){this.$refs.fileInput.$el.click()},validate:function(){return this.request.image.type.startsWith("image")},upload:function(){var t=this;this.submitting=!0,setTimeout((function(){if(t.validate()){var e=new FormData;for(var o in t.request)e.append(o,t.request[o]);t.url&&e.append("url",t.url),t.folder&&e.append("folder",t.folder),t.$axios.$post("".concat(t.action||"/cms/upload/local/image"),e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){t.submitting=!1,t.request.image=null,t.$emit("uploaded",{id:t.id,url:e.url})})).catch((function(e){t.submitting=!1,t.$toast.error(e.response.data.error.message),t.request.image=null}))}else t.submitting=!1,t.$toast.error("Unsopported type. Please, select image")}),500)}}},n=(o(469),o(21)),component=Object(n.a)(r,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"component imageUploader"},[o("div",{staticClass:"imageContainter",on:{click:t.revokeFileUploader}},[t.url?o("img",{attrs:{src:(t.baseURL||t.imgBaseURL)+"/"+t.url}}):t._e(),t._v(" "),o("b-form-file",{ref:"fileInput",staticClass:"fileInput",attrs:{plain:"",accept:"image/*"},on:{change:t.upload},model:{value:t.request.image,callback:function(e){t.$set(t.request,"image",e)},expression:"request.image"}}),t._v(" "),t.submitting?o("div",{staticClass:"loadingOverlay"},[o("b-spinner",{attrs:{variant:"primary",type:"grow",label:"Loading..."}})],1):t._e()],1)])}),[],!1,null,"85256baa",null);e.a=component.exports},469:function(t,e,o){"use strict";o(462)},470:function(t,e,o){var r=o(29),n=o(271),c=o(463);e=r(!1);var l=n(c);e.push([t.i,".modal-dialog .confirm-box-body[data-v-85256baa]{text-align:center}.modal-dialog .confirm-box-body-confirm[data-v-85256baa]{text-align:center;padding-top:40px}.modal-dialog .confirm-box-footer-confirm[data-v-85256baa]{height:120px;padding-bottom:50px;border-top:none;justify-content:center}.modal-dialog .confirm-box-footer-confirm .btn-secondary[data-v-85256baa]{background-color:#363636;color:#363636;background-color:#fff}.modal-dialog .confirm-box-footer-confirm .btn-primary[data-v-85256baa],.modal-dialog .confirm-box-footer-confirm .btn-secondary[data-v-85256baa]{font-size:13px;border:1px solid #363636;border-radius:30px;padding:5px 45px;margin-left:-163px;font-weight:700;margin-right:-163px}.modal-dialog .confirm-box-footer-confirm .btn-primary[data-v-85256baa]{color:#fff;background-color:#363636}.modal-dialog .confirm-box-footer[data-v-85256baa]{border-top:none;justify-content:center}.modal-dialog .confirm-box-footer button[data-v-85256baa]{background:#363636;color:#fff;border:none;outline:none}.modal-dialog .confirm-box-footer button.btn-secondary[data-v-85256baa]{opacity:.5}.modal-content .modal-header[data-v-85256baa]{margin-left:-1px;margin-top:-1px;background-color:#363636;color:#fff}.white-button[data-v-85256baa]{background-color:#363636;color:#363636;background-color:#fff}.black-button[data-v-85256baa],.white-button[data-v-85256baa]{font-size:13px;border:1px solid #363636;border-radius:30px;padding:5px 45px;margin-left:20px;font-weight:600;margin-right:20px;text-transform:uppercase}.black-button[data-v-85256baa]{color:#fff;background-color:#363636}.component.imageUploader .imageContainter[data-v-85256baa]{position:relative;border:1px dashed #ccc;display:inline-block;padding:5px;border-radius:4px;width:100px;height:100px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:border-color .2s;background:url("+l+") no-repeat 50%;background-size:60%}.component.imageUploader .imageContainter[data-v-85256baa]:hover{border-color:#000}.component.imageUploader .imageContainter img[data-v-85256baa]{max-width:90px;max-height:90px}.component.imageUploader .imageContainter .fileInput[data-v-85256baa]{display:none}.component.imageUploader .imageContainter .loadingOverlay[data-v-85256baa]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;background:rgba(0,0,0,.3);display:flex;align-items:center;justify-content:center}",""]),t.exports=e},518:function(t,e,o){var content=o(643);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(30).default)("1a0f67d4",content,!0,{sourceMap:!1})},642:function(t,e,o){"use strict";o(518)},643:function(t,e,o){(e=o(29)(!1)).push([t.i,".modal-dialog .confirm-box-body{text-align:center}.modal-dialog .confirm-box-body-confirm{text-align:center;padding-top:40px}.modal-dialog .confirm-box-footer-confirm{height:120px;padding-bottom:50px;border-top:none;justify-content:center}.modal-dialog .confirm-box-footer-confirm .btn-secondary{background-color:#363636;color:#363636;background-color:#fff}.modal-dialog .confirm-box-footer-confirm .btn-primary,.modal-dialog .confirm-box-footer-confirm .btn-secondary{font-size:13px;border:1px solid #363636;border-radius:30px;padding:5px 45px;margin-left:-163px;font-weight:700;margin-right:-163px}.modal-dialog .confirm-box-footer-confirm .btn-primary{color:#fff;background-color:#363636}.modal-dialog .confirm-box-footer{border-top:none;justify-content:center}.modal-dialog .confirm-box-footer button{background:#363636;color:#fff;border:none;outline:none}.modal-dialog .confirm-box-footer button.btn-secondary{opacity:.5}.modal-content .modal-header{margin-left:-1px;margin-top:-1px;background-color:#363636;color:#fff}.white-button{background-color:#363636;color:#363636;background-color:#fff}.black-button,.white-button{font-size:13px;border:1px solid #363636;border-radius:30px;padding:5px 45px;margin-left:20px;font-weight:600;margin-right:20px;text-transform:uppercase}.black-button{color:#fff;background-color:#363636}#cms-posts-list th{font-size:13px}#cms-posts-list td{font-size:12px}.cmscomponent.list .actions-container{display:flex;justify-content:space-between;align-items:middle;background:#ddd;padding:10px;border-radius:5px}.cmscomponent.list .actions-container .form-control{height:38px}.cmscomponent.list .actions-container .pagination{margin:0}",""]),t.exports=e},714:function(t,e,o){"use strict";o.r(e);o(130);var r={data:function(){return{items:[],perPage:20,currentPage:1,total:0,fields:[{key:"id",label:"ID"},{key:"cover",label:"Cover"},{key:"translations[0].title",label:"Title (EN)"},{key:"translations[1].title",label:"Title (CH)"}],loading:!1,searchTerm:{tmp:"",value:""},imgBaseURL:"https://newapi.collectionstock.com"}},methods:{load:function(t){var e=this;this.loading=!0,this.$axios.$get("/cms/posts?page=".concat(t).concat(this.searchTerm.value?"&term="+this.searchTerm.value:"")).then((function(t){e.items=t.data,e.total=t.total,e.loading=!1,document.querySelector(".menuframe").scrollTop=0}))},search:function(){this.searchTerm.value=this.searchTerm.tmp,this.currentPage=1,this.load(this.currentPage),document.querySelector(".search-input").blur()},resetSearch:function(){this.searchTerm.tmp="",this.search()},select:function(t,e,o){this.$router.push("/cms/extra?id=".concat(t.id))},refresh:function(){this.load(this.currentPage)}},mounted:function(){var t=this;this.$nextTick((function(){t.load(t.currentPage)}))}},n=(o(642),o(21)),c=Object(n.a)(r,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"cmscomponent list"},[o("div",{staticClass:"actions-container"},[o("div",[o("form",{on:{submit:function(e){return e.preventDefault(),t.search(e)}}},[o("b-input-group",{attrs:{size:"sm"}},[o("b-form-input",{staticClass:"search-input",attrs:{placeholder:"Search by name"},model:{value:t.searchTerm.tmp,callback:function(e){t.$set(t.searchTerm,"tmp",e)},expression:"searchTerm.tmp"}}),t._v(" "),o("b-input-group-append",[o("b-button",{directives:[{name:"show",rawName:"v-show",value:t.searchTerm.value,expression:"searchTerm.value"}],attrs:{variant:"secondary",type:"button"},on:{click:t.resetSearch}},[t._v("Reset")]),t._v(" "),o("b-button",{attrs:{variant:"primary",type:"submit"}},[t._v("Search")])],1)],1)],1)]),t._v(" "),o("div",[o("b-pagination",{attrs:{"total-rows":t.total,"per-page":t.perPage,"aria-controls":"cms-posts-list"},on:{change:t.load},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)]),t._v(" "),o("div",{staticClass:"additional-actions"},[o("div",[t._v(" ")]),t._v(" "),o("div",{staticClass:"total-count"},[t._v("\n      Total: "),o("strong",[t._v(t._s(t.total))])])]),t._v(" "),o("b-table",{attrs:{id:"cms-posts-list",items:t.items,fields:t.fields,busy:t.loading,"select-mode":"single","sticky-header":"",small:"",selectable:"",striped:""},on:{"row-clicked":t.select},scopedSlots:t._u([{key:"cell(cover)",fn:function(data){return[o("img",{staticStyle:{height:"30px"},attrs:{src:t.imgBaseURL+"/storage/"+data.item.cover}})]}}])})],1)}),[],!1,null,null,null).exports,l=o(466),d={props:["itemId"],components:{ImageUploader:l.a},data:function(){return{item:null,loading:!1}},methods:{load:function(){var t=this;this.$axios.$get("/cms/posts/".concat(this.itemId)).then((function(e){t.item=e}))},cancel:function(){this.$emit("updated",{clearItemFrame:!0})},coverUploaded:function(t){var e=this,o=t.url;this.$axios.$patch("/posts/".concat(this.itemId),{cover:o}).then((function(t){console.log(t),e.$toast.success("Image updated successfully"),e.item.cover=t.cover,e.$emit("updated",{refresh:!0})})).catch((function(t){e.$toast.error(t.response.data.error.message)}))},coverUploaded2:function(t){var e=this,o=t.url;this.$axios.$patch("/posts/".concat(this.itemId),{cover_2:o}).then((function(t){console.log(t),e.$toast.success("Image updated successfully"),e.item.main_cover=t.main_cover,e.$emit("updated",{refresh:!0})})).catch((function(t){e.$toast.error(t.response.data.error.message)}))},update:function(t){var e=this;this.loading=!0,this.$axios.$patch("/posts/".concat(this.itemId),{titleEN:t.target.elements.titleEN.value,titleCH:t.target.elements.titleCH.value,descriptionEN:this.item.translations[0].description,descriptionCH:this.item.translations[1].description}).then((function(t){console.log(t),e.loading=!1,e.$toast.success("Post updated successfully"),e.$emit("updated",{refresh:!0})})).catch((function(t){e.loading=!1,t.response.data.errors.map(function(t){this.$toast.error(t)}.bind(e))}))},deleteItem:function(){var t=this;this.$bvModal.msgBoxConfirm("Are you sure?",{centered:!0,bodyClass:"confirm-box-body",footerClass:"confirm-box-footer"}).then((function(e){if(e){var o=t.itemId;t.$axios.$delete("/posts/".concat(o)).then((function(e){t.$toast.success("Post deleted successfully"),t.cancel()})).catch((function(e){t.$toast.error(e.response.data.error.message)}))}}))}},watch:{itemId:function(){this.item=null,this.load()}},mounted:function(){var t=this;this.$nextTick((function(){t.load()}))}},m=Object(n.a)(d,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"cmscomponent item extra"},[t.item?t._e():o("div",{staticStyle:{"text-align":"center"}},[o("b-spinner",{attrs:{type:"grow",label:"Loading..."}})],1),t._v(" "),t.item?o("div",[o("div",{staticClass:"title"},[o("span",[o("i",{staticClass:"far fa-edit"}),t._v("  ID: "+t._s(t.item.id))]),t._v(" "),o("div",[o("b-button",{attrs:{variant:"outline-danger",size:"sm"},on:{click:t.deleteItem}},[o("i",{staticClass:"fas fa-trash"}),t._v("  Delete\n                ")]),t._v(" "),o("b-button",{attrs:{variant:"outline-secondary",size:"sm"},on:{click:t.cancel}},[t._v("Cancel")])],1)]),t._v(" "),o("hr"),t._v(" "),o("form",{on:{submit:function(e){return e.preventDefault(),t.update(e)}}},[o("div",{staticClass:"item-content"},[o("div",{staticClass:"item-row"},[o("div",{staticClass:"prop"},[t._v("Cover")]),t._v(" "),o("div",{staticClass:"value"},[o("input",{attrs:{type:"hidden",name:"cover"},domProps:{value:t.item.cover}}),t._v(" "),o("ImageUploader",{attrs:{id:-1,url:t.item.cover,folder:"posts"},on:{uploaded:t.coverUploaded}})],1)]),t._v(" "),o("div",{staticClass:"item-row"},[o("div",{staticClass:"prop"},[t._v("Main Cover")]),t._v(" "),o("div",{staticClass:"value"},[o("input",{attrs:{type:"hidden",name:"cover_2"},domProps:{value:t.item.main_cover}}),t._v(" "),o("ImageUploader",{attrs:{id:-1,url:t.item.main_cover,folder:"posts"},on:{uploaded:t.coverUploaded2}})],1)]),t._v(" "),o("div",{staticClass:"item-row"},[o("div",{staticClass:"prop"},[t._v("Title (EN)")]),t._v(" "),o("div",{staticClass:"value"},[o("b-input",{attrs:{type:"text",name:"titleEN",value:t.item.translations[0].title,required:""}})],1)]),t._v(" "),o("div",{staticClass:"item-row"},[o("div",{staticClass:"prop"},[t._v("Title (CH)")]),t._v(" "),o("div",{staticClass:"value"},[o("b-input",{attrs:{type:"text",name:"titleCH",value:t.item.translations[1].title,required:""}})],1)]),t._v(" "),o("div",{staticClass:"item-row"},[o("div",{staticClass:"value"},[o("div",{staticClass:"prop"},[t._v("Description (EN)")]),t._v(" "),o("br"),t._v(" "),o("wysiwyg",{staticStyle:{background:"#fff"},model:{value:t.item.translations[0].description,callback:function(e){t.$set(t.item.translations[0],"description",e)},expression:"item.translations[0].description"}})],1)]),t._v(" "),o("div",{staticClass:"item-row"},[o("div",{staticClass:"value"},[o("div",{staticClass:"prop"},[t._v("Description (CH)")]),t._v(" "),o("br"),t._v(" "),o("wysiwyg",{staticStyle:{background:"#fff"},model:{value:t.item.translations[1].description,callback:function(e){t.$set(t.item.translations[1],"description",e)},expression:"item.translations[1].description"}})],1)])]),t._v(" "),o("div",{staticClass:"item-actions"},[o("b-button",{attrs:{variant:"primary",type:"submit",disabled:t.loading}},[o("i",{staticClass:"far fa-edit"}),t._v("  Update\n                ")])],1)])]):t._e()])}),[],!1,null,"4b30467c",null).exports,f={components:{ImageUploader:l.a},data:function(){return{loading:!1,item:{cover:"",cover_2:"",titleEN:"",titleCH:"",descriptionEN:"",descriptionCH:""}}},methods:{cancel:function(){this.$emit("updated",{clearItemFrame:!0})},coverUploaded:function(t){var e=t.url;this.item.cover=e},coverUploaded2:function(t){var e=t.url;this.item.cover_2=e},create:function(){var t=this;this.loading=!0,this.$axios.$post("/cms/posts",this.item).then((function(e){t.loading=!1,t.$toast.success("New post added successfully"),t.cancel()})).catch((function(e){t.loading=!1,e.response.data.errors.map(function(t){this.$toast.error(t)}.bind(t))}))}}},v={middleware:"cmsuser",layout:"cms",components:{PostList:c,PostItem:m,CreateForm:Object(n.a)(f,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"cmscomponent item extra create"},[o("div",{staticClass:"title"},[t._m(0),t._v(" "),o("b-button",{attrs:{variant:"outline-secondary",size:"sm"},on:{click:t.cancel}},[t._v("Cancel")])],1),t._v(" "),o("hr"),t._v(" "),o("form",{on:{submit:function(e){return e.preventDefault(),t.create(e)}}},[o("div",{staticClass:"item-content"},[o("small",[t._v("Dimension : 379 * 300")]),t._v(" "),o("div",{staticClass:"item-row"},[o("div",{staticClass:"prop"},[t._v("Overview Image")]),t._v(" "),o("div",{staticClass:"value"},[o("ImageUploader",{attrs:{id:-1,url:t.item.cover,folder:"posts"},on:{uploaded:t.coverUploaded}})],1)]),t._v(" "),o("small",[t._v("Dimension : 1200 * 400")]),t._v(" "),o("div",{staticClass:"item-row"},[o("div",{staticClass:"prop"},[t._v("Content Image")]),t._v(" "),o("div",{staticClass:"value"},[o("ImageUploader",{attrs:{id:-1,url:t.item.cover_2,folder:"posts"},on:{uploaded:t.coverUploaded2}})],1)]),t._v(" "),o("div",{staticClass:"item-row"},[o("div",{staticClass:"prop"},[t._v("Title (EN)")]),t._v(" "),o("div",{staticClass:"value"},[o("b-input",{attrs:{type:"text",name:"titleEN",required:""},model:{value:t.item.titleEN,callback:function(e){t.$set(t.item,"titleEN",e)},expression:"item.titleEN"}})],1)]),t._v(" "),o("div",{staticClass:"item-row"},[o("div",{staticClass:"prop"},[t._v("Title (CH)")]),t._v(" "),o("div",{staticClass:"value"},[o("b-input",{attrs:{type:"text",name:"titleCH",required:""},model:{value:t.item.titleCH,callback:function(e){t.$set(t.item,"titleCH",e)},expression:"item.titleCH"}})],1)]),t._v(" "),o("div",{staticClass:"item-row"},[o("div",{staticClass:"value"},[o("div",{staticClass:"prop"},[t._v("Description (EN)")]),t._v(" "),o("br"),t._v(" "),o("wysiwyg",{staticStyle:{background:"#fff"},model:{value:t.item.descriptionEN,callback:function(e){t.$set(t.item,"descriptionEN",e)},expression:"item.descriptionEN"}})],1)]),t._v(" "),o("div",{staticClass:"item-row"},[o("div",{staticClass:"value"},[o("div",{staticClass:"prop"},[t._v("Description (CH)")]),t._v(" "),o("br"),t._v(" "),o("wysiwyg",{staticStyle:{background:"#fff"},model:{value:t.item.descriptionCH,callback:function(e){t.$set(t.item,"descriptionCH",e)},expression:"item.descriptionCH"}})],1)])]),t._v(" "),o("div",{staticClass:"item-actions"},[o("b-button",{attrs:{variant:"primary",type:"submit",disabled:t.loading}},[o("i",{staticClass:"fas fa-plus"}),t._v("  Create\n            ")])],1)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",[e("i",{staticClass:"fas fa-plus"}),this._v("  ID: Add new post")])}],!1,null,"b373aa82",null).exports},data:function(){return{itemId:null}},methods:{openCreateForm:function(){this.$router.push("/cms/extra?id=-1")},updated:function(t){var e=t.refresh,o=t.clearItemFrame;!0===e&&this.$refs.list.refresh(),!0===o&&(this.itemId=null,this.$router.push("/cms/extra"),this.$refs.list.refresh())},onRouteUpdate:function(){this.itemId=this.$route.query.id}},watch:{$route:function(){this.onRouteUpdate()}},mounted:function(){var t=this;this.$nextTick((function(){t.onRouteUpdate()}))}},h=Object(n.a)(v,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"cmspage extra"},[o("div",{staticClass:"contentframe"},[o("div",{staticClass:"menuframe"},[o("div",{staticClass:"title"},[t._m(0),t._v(" "),o("b-button",{attrs:{variant:"outline-success",size:"sm"},on:{click:t.openCreateForm}},[o("i",{staticClass:"fas fa-plus"}),t._v("  Add new post")])],1),t._v(" "),o("hr"),t._v(" "),o("PostList",{ref:"list"})],1),t._v(" "),o("div",{staticClass:"itemframe"},[-1==t.itemId?o("CreateForm",{on:{updated:t.updated}}):t.itemId?o("PostItem",{attrs:{itemId:t.itemId},on:{updated:t.updated}}):t._e()],1)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",[e("i",{staticClass:"fas fa-rss"}),this._v("  Posts")])}],!1,null,"2115c312",null);e.default=h.exports}}]);